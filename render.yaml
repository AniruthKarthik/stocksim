services:
  # ------------------------------------
  # 1. BACKEND SERVICE
  # ------------------------------------
  - type: web
    name: stocksim-backend
    env: python
    plan: free
    rootDir: . 
    
    # Install dependencies from the backend folder
    buildCommand: pip install -r backend/requirements.txt
    
    # Run the app from the root
    startCommand: uvicorn backend.main:app --host 0.0.0.0 --port 10000
    
    envVars:
      - key: PYTHON_VERSION
        value: 3.11.0
      - key: ALLOWED_ORIGINS
        value: "*" 
      # You will need to add DB credentials manually in the Render Dashboard
      # DB_HOST, DB_NAME, DB_USER, DB_PASSWORD, DB_PORT

  # ------------------------------------
  # 2. FRONTEND SERVICE
  # ------------------------------------
  - type: web
    name: stocksim-frontend
    env: node
    plan: free
    rootDir: frontend
    
    # Build the Next.js app
    buildCommand: npm install && npm run build
    
    # Start the Next.js server
    startCommand: npm start
    
    envVars:
      - key: NODE_VERSION
        value: 20.11.0
      # Updated to match your actual backend URL
      - key: NEXT_PUBLIC_API_URL
        value: https://stocksim-log.onrender.com
